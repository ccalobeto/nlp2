<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="twitter:card" content="summary_large_image" /><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>NLP in Action | NLP Notes</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="NLP in Action" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="My journey to learn NLP" />
<meta property="og:description" content="My journey to learn NLP" />
<link rel="canonical" href="https://ccalobeto.github.io/nlp2/fastpages/jupyter/2021/02/13/nlp-in-action-i.html" />
<meta property="og:url" content="https://ccalobeto.github.io/nlp2/fastpages/jupyter/2021/02/13/nlp-in-action-i.html" />
<meta property="og:site_name" content="NLP Notes" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-02-13T00:00:00-06:00" />
<script type="application/ld+json">
{"url":"https://ccalobeto.github.io/nlp2/fastpages/jupyter/2021/02/13/nlp-in-action-i.html","@type":"BlogPosting","headline":"NLP in Action","dateModified":"2021-02-13T00:00:00-06:00","datePublished":"2021-02-13T00:00:00-06:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://ccalobeto.github.io/nlp2/fastpages/jupyter/2021/02/13/nlp-in-action-i.html"},"description":"My journey to learn NLP","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/nlp2/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://ccalobeto.github.io/nlp2/feed.xml" title="NLP Notes" /><link rel="shortcut icon" type="image/x-icon" href="/nlp2/images/favicon.ico"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Primer/15.2.0/primer.css" integrity="sha512-xTz2ys4coGAOz8vuV1NcQBkgVmKhsSEtjbqyMJbBHRplFuvKIUo6xhLHpAyPt9mfR6twHJgn9OgVLuqOvjeBhg==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous" />

<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/nlp2/">NLP Notes</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/nlp2/about/">About Me</a><a class="page-link" href="/nlp2/search/">Search</a><a class="page-link" href="/nlp2/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">NLP in Action</h1><p class="page-description">My journey to learn NLP</p><p class="post-meta post-meta-title"><time class="dt-published" datetime="2021-02-13T00:00:00-06:00" itemprop="datePublished">
        Feb 13, 2021
      </time>
       â€¢ <span class="read-time" title="Estimated read time">
    
    
      12 min read
    
</span></p>

    
      <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i></i> 
      
        <a class="category-tags-link" href="/nlp2/categories/#fastpages">fastpages</a>
        &nbsp;
      
        <a class="category-tags-link" href="/nlp2/categories/#jupyter">jupyter</a>
        
      
      </p>
    

    
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    <ul class="section-nav">
<li class="toc-entry toc-h2"><a href="#System-tools">System tools </a>
<ul>
<li class="toc-entry toc-h3"><a href="#Install-a-pip-package-in-the-current-Jupyter-kernel">Install a pip package in the current Jupyter kernel </a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#NLP-Tools">NLP Tools </a>
<ul>
<li class="toc-entry toc-h3"><a href="#Regular-Expressions">Regular Expressions </a>
<ul>
<li class="toc-entry toc-h4"><a href="#basics-of-regular-expressions">basics of regular expressions </a></li>
</ul>
</li>
<li class="toc-entry toc-h3"><a href="#Simple-Chat-Bot">Simple Chat Bot </a></li>
<li class="toc-entry toc-h3"><a href="#Word-Permutations">Word Permutations </a></li>
<li class="toc-entry toc-h3"><a href="#Count-Words">Count Words </a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#Word-Tokenization">Word Tokenization </a>
<ul>
<li class="toc-entry toc-h3"><a href="#Tokens">Tokens </a>
<ul>
<li class="toc-entry toc-h4"><a href="#split-into-tokens">split into tokens </a></li>
<li class="toc-entry toc-h4"><a href="#ignoring-punctuation">ignoring punctuation </a></li>
<li class="toc-entry toc-h4"><a href="#ignoring-whitespaces-with-tokeneizer">ignoring whitespaces with tokeneizer </a></li>
<li class="toc-entry toc-h4"><a href="#managing-contractions-with-tokeneizer">managing contractions with tokeneizer </a></li>
<li class="toc-entry toc-h4"><a href="#tokenize-informal-conversation">tokenize informal conversation </a></li>
</ul>
</li>
<li class="toc-entry toc-h3"><a href="#n-grams">n-grams </a></li>
<li class="toc-entry toc-h3"><a href="#Stopwords">Stopwords </a></li>
<li class="toc-entry toc-h3"><a href="#Normalizing-capitalization">Normalizing capitalization </a></li>
<li class="toc-entry toc-h3"><a href="#Stemming">Stemming </a>
<ul>
<li class="toc-entry toc-h4"><a href="#stemmer-with-regular-expressions">stemmer with regular expressions </a></li>
<li class="toc-entry toc-h4"><a href="#complete-stemmer">complete stemmer </a></li>
</ul>
</li>
<li class="toc-entry toc-h3"><a href="#Lemmatization">Lemmatization </a></li>
<li class="toc-entry toc-h3"><a href="#Sentiment-analysis">Sentiment analysis </a>
<ul>
<li class="toc-entry toc-h4"><a href="#vader-model-for-sentiment-analysis">vader model for sentiment analysis </a></li>
<li class="toc-entry toc-h4"><a href="#sentiment-score-for-a-given-corpus">sentiment score for a given corpus </a></li>
<li class="toc-entry toc-h4"><a href="#can't-install-nlpia">can&#39;t install nlpia </a></li>
<li class="toc-entry toc-h4"><a href="#A-complete-path-for-predicting-sentiment-analysis">A complete path for predicting sentiment analysis </a></li>
</ul>
</li>
</ul>
</li>
</ul><!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2021-02-13-nlp-in-action-i.ipynb
-->

<div class="container" id="notebook-container">
        
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="System-tools">
<a class="anchor" href="#System-tools" aria-hidden="true"><span class="octicon octicon-link"></span></a>System tools<a class="anchor-link" href="#System-tools"> </a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Install-a-pip-package-in-the-current-Jupyter-kernel">
<a class="anchor" href="#Install-a-pip-package-in-the-current-Jupyter-kernel" aria-hidden="true"><span class="octicon octicon-link"></span></a>Install a pip package in the current Jupyter kernel<a class="anchor-link" href="#Install-a-pip-package-in-the-current-Jupyter-kernel"> </a>
</h3>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># !{sys.executable} -m pip install vaderSentiment</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="NLP-Tools">
<a class="anchor" href="#NLP-Tools" aria-hidden="true"><span class="octicon octicon-link"></span></a>NLP Tools<a class="anchor-link" href="#NLP-Tools"> </a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Regular-Expressions">
<a class="anchor" href="#Regular-Expressions" aria-hidden="true"><span class="octicon octicon-link"></span></a>Regular Expressions<a class="anchor-link" href="#Regular-Expressions"> </a>
</h3>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">re</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="basics-of-regular-expressions">
<a class="anchor" href="#basics-of-regular-expressions" aria-hidden="true"><span class="octicon octicon-link"></span></a>basics of regular expressions<a class="anchor-link" href="#basics-of-regular-expressions"> </a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>[] indicates character class</li>
<li>r'[\s]' is equivalent to r'\t\n\r\x0b\x0c' match all the spaces, tabs, returns, new lines and 
form-feed</li>
<li>r'[a-z]' match all lowercase</li>
<li>r'[0-9]' match any digit</li>
<li>r'[_a-zA-Z]' match any underscore character or letter of the english alphabet</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Match any sentence that begins with hi|hello|hey followed by space(s) and a word</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">r</span> <span class="o">=</span> <span class="s2">"(hi|hello|hey)[ ]*([a-z]*)"</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="s1">'Hello Rosa'</span><span class="p">,</span> <span class="n">flags</span><span class="o">=</span><span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="s2">"hi ho, hi ho, it's off to work ..."</span><span class="p">,</span> <span class="n">flags</span><span class="o">=</span><span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="s2">"hey, what's up"</span><span class="p">,</span> <span class="n">flags</span><span class="o">=</span><span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>&lt;re.Match object; span=(0, 10), match='Hello Rosa'&gt;
None
&lt;re.Match object; span=(0, 9), match='hey, what'&gt;
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Example with a complex pattern</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">r</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">"[^a-z]*([y]o|[h']?ello|ok|hey|(good[ ])?(morn[gin']{0,3}|"</span>\
     <span class="sa">r</span><span class="s2">"afternoon|even[gin']{0,3}))[\s,;:]{1,3}([a-z]{1,20})"</span>

<span class="n">re_greeting</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">flags</span><span class="o">=</span><span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">re_greeting</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s1">'Hello Rosa'</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">re_greeting</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s1">'Hello Rosa'</span><span class="p">)</span><span class="o">.</span><span class="n">groups</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">re_greeting</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">"Good morning Rosa"</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">re_greeting</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">"Good Manning Rosa"</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">re_greeting</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s1">'Good evening Rosa Parks'</span><span class="p">)</span><span class="o">.</span><span class="n">groups</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">re_greeting</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">"Good Morn'n Rosa"</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">re_greeting</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">"yo Rosa"</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>&lt;re.Match object; span=(0, 10), match='Hello Rosa'&gt;
('Hello', None, None, 'Rosa')
&lt;re.Match object; span=(0, 17), match='Good morning Rosa'&gt;
None
('Good evening', 'Good ', 'evening', 'Rosa')
&lt;re.Match object; span=(0, 16), match="Good Morn'n Rosa"&gt;
&lt;re.Match object; span=(0, 7), match='yo Rosa'&gt;
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Simple-Chat-Bot">
<a class="anchor" href="#Simple-Chat-Bot" aria-hidden="true"><span class="octicon octicon-link"></span></a>Simple Chat Bot<a class="anchor-link" href="#Simple-Chat-Bot"> </a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Enter the text 'good morning rosa or hello rose'</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">my_names</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="s1">'rosa'</span><span class="p">,</span> <span class="s1">'rose'</span><span class="p">,</span> <span class="s1">'chatty'</span><span class="p">,</span> <span class="s1">'chatbot'</span><span class="p">,</span> <span class="s1">'bot'</span><span class="p">,</span> <span class="s1">'chatterbot'</span><span class="p">])</span>
<span class="n">curt_names</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="s1">'hal'</span><span class="p">,</span> <span class="s1">'you'</span><span class="p">,</span> <span class="s1">'u'</span><span class="p">])</span>
<span class="n">greeter_name</span> <span class="o">=</span> <span class="s1">''</span>
<span class="n">match</span> <span class="o">=</span> <span class="n">re_greeting</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="nb">input</span><span class="p">())</span>

<span class="k">if</span> <span class="n">match</span><span class="p">:</span>
    <span class="n">at_name</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">groups</span><span class="p">()[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">at_name</span> <span class="ow">in</span> <span class="n">curt_names</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">"Good one."</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">at_name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="n">my_names</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">"Hi </span><span class="si">{}</span><span class="s2">, How are you?"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">greeter_name</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Hi , How are you?
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Word-Permutations">
<a class="anchor" href="#Word-Permutations" aria-hidden="true"><span class="octicon octicon-link"></span></a>Word Permutations<a class="anchor-link" href="#Word-Permutations"> </a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>n=3 permutations with text 'Good morning Rosa!'</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">permutations</span>
<span class="nb">print</span><span class="p">([</span><span class="s2">" "</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">combo</span><span class="p">)</span> <span class="k">for</span> <span class="n">combo</span> <span class="ow">in</span> <span class="n">permutations</span><span class="p">(</span><span class="s2">"Good morning Rosa!"</span><span class="o">.</span><span class="n">split</span><span class="p">(),</span> <span class="mi">3</span><span class="p">)])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>['Good morning Rosa!', 'Good Rosa! morning', 'morning Good Rosa!', 'morning Rosa! Good', 'Rosa! Good morning', 'Rosa! morning Good']
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Count-Words">
<a class="anchor" href="#Count-Words" aria-hidden="true"><span class="octicon octicon-link"></span></a>Count Words<a class="anchor-link" href="#Count-Words"> </a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Counting words using Counter. Dict output</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">Counter</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Counter</span><span class="p">(</span><span class="s2">"Guten Morgen Rosa"</span><span class="o">.</span><span class="n">split</span><span class="p">()))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Counter</span><span class="p">(</span><span class="s2">"Good morning morning , Rosa!"</span><span class="o">.</span><span class="n">split</span><span class="p">()))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Counter({'Guten': 1, 'Morgen': 1, 'Rosa': 1})
Counter({'morning': 2, 'Good': 1, ',': 1, 'Rosa!': 1})
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Word-Tokenization">
<a class="anchor" href="#Word-Tokenization" aria-hidden="true"><span class="octicon octicon-link"></span></a>Word Tokenization<a class="anchor-link" href="#Word-Tokenization"> </a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Tokens">
<a class="anchor" href="#Tokens" aria-hidden="true"><span class="octicon octicon-link"></span></a>Tokens<a class="anchor-link" href="#Tokens"> </a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="split-into-tokens">
<a class="anchor" href="#split-into-tokens" aria-hidden="true"><span class="octicon octicon-link"></span></a>split into tokens<a class="anchor-link" href="#split-into-tokens"> </a>
</h4>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sentence</span> <span class="o">=</span> <span class="s2">"Thomas Jefferson began building Monticello at age of 26."</span>
<span class="n">sentence</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
<span class="nb">str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">sentence</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>['Thomas',
 'Jefferson',
 'began',
 'building',
 'Monticello',
 'at',
 'age',
 'of',
 '26.']</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>split a sentence into tokens, order it and convert to a vector</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">token_sequence</span> <span class="o">=</span> <span class="nb">str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">sentence</span><span class="p">)</span>
<span class="n">vocab</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">token_sequence</span><span class="p">))</span>
<span class="n">num_tokens</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">token_sequence</span><span class="p">)</span>
<span class="n">vocab_size</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">vocab</span><span class="p">)</span>
<span class="n">onehot_vectors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">num_tokens</span><span class="p">,</span> <span class="n">vocab_size</span><span class="p">),</span> <span class="nb">int</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">word</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">token_sequence</span><span class="p">):</span>
    <span class="n">onehot_vectors</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">vocab</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">word</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">1</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">', '</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">vocab</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'*********************'</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">onehot_vectors</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>26., Jefferson, Monticello, Thomas, age, at, began, building, of
*********************
[[0 0 0 1 0 0 0 0 0]
 [0 1 0 0 0 0 0 0 0]
 [0 0 0 0 0 0 1 0 0]
 [0 0 0 0 0 0 0 1 0]
 [0 0 1 0 0 0 0 0 0]
 [0 0 0 0 0 1 0 0 0]
 [0 0 0 0 1 0 0 0 0]
 [0 0 0 0 0 0 0 0 1]
 [1 0 0 0 0 0 0 0 0]]
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Building a dataframe with matrix of vectors</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">onehot_vectors</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">vocab</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>   26.  Jefferson  Monticello  Thomas  age  at  began  building  of
0    0          0           0       1    0   0      0         0   0
1    0          1           0       0    0   0      0         0   0
2    0          0           0       0    0   0      1         0   0
3    0          0           0       0    0   0      0         1   0
4    0          0           1       0    0   0      0         0   0
5    0          0           0       0    0   1      0         0   0
6    0          0           0       0    1   0      0         0   0
7    0          0           0       0    0   0      0         0   1
8    1          0           0       0    0   0      0         0   0
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>construct a frequency vector</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sentences</span> <span class="o">=</span> <span class="s2">"""Thomas Jefferson began building Monticello at the age of 26.</span><span class="se">\n</span><span class="s2">"""</span>
<span class="n">sentences</span> <span class="o">+=</span> <span class="s2">"""Construction was done mostly by local masons and carpenters.</span><span class="se">\n</span><span class="s2">"""</span>
<span class="n">sentences</span> <span class="o">+=</span> <span class="s2">"He moved into the South Pavilion in 1770.</span><span class="se">\n</span><span class="s2">"</span>
<span class="n">sentences</span> <span class="o">+=</span> <span class="s2">"""Turning Monticello into a neoclassical masterpiece was Jefferson's obsession."""</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">'text to analize:'</span><span class="p">,</span> <span class="n">sentences</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'*********************************************************'</span><span class="p">)</span>

<span class="c1">#1. construct a dict of dicts</span>
<span class="n">corpus</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">sent</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">sentences</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">'</span><span class="se">\n</span><span class="s1">'</span><span class="p">)):</span>
    <span class="n">corpus</span><span class="p">[</span><span class="s1">'sent</span><span class="si">{}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">)]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">((</span><span class="n">tok</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">tok</span> <span class="ow">in</span> <span class="n">sent</span><span class="o">.</span><span class="n">split</span><span class="p">())</span> 

<span class="nb">print</span><span class="p">(</span><span class="s1">'first dict:'</span><span class="p">,</span> <span class="n">corpus</span><span class="p">[</span><span class="s1">'sent0'</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'*********************************************************'</span><span class="p">)</span>
<span class="c1">#2. convert dict to dataframe </span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_records</span><span class="p">(</span><span class="n">corpus</span><span class="p">)</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">[:</span><span class="mi">10</span><span class="p">]])</span>
<span class="c1">#	    Thomas	Jefferson	began	building	Monticello	at	the	age	of	26.</span>
<span class="c1"># sent0	    1	    1	    1	        1	        1	    1	1	1	1	1</span>
<span class="c1"># sent1	    0	    0	    0	        0	        0	    0	0	0	0	0</span>
<span class="c1"># sent2	    0	    0	    0	        0	        0	    0	1	0	0	0</span>
<span class="c1"># sent3	    0	    0	    0	        0	        1	    0	0	0	0	0</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">'**********************************************************'</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'word shared by two sentences:'</span><span class="p">,[(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="ow">in</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">'sent0'</span><span class="p">]</span> <span class="o">&amp;</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">'sent3'</span><span class="p">])</span><span class="o">.</span>
                                       <span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">v</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>text to analize: Thomas Jefferson began building Monticello at the age of 26.
Construction was done mostly by local masons and carpenters.
He moved into the South Pavilion in 1770.
Turning Monticello into a neoclassical masterpiece was Jefferson's obsession.
*********************************************************
first dict: {'Thomas': 1, 'Jefferson': 1, 'began': 1, 'building': 1, 'Monticello': 1, 'at': 1, 'the': 1, 'age': 1, 'of': 1, '26.': 1}
*********************************************************
       Thomas  Jefferson  began  building  Monticello  at  the  age  of  26.
sent0       1          1      1         1           1   1    1    1   1    1
sent1       0          0      0         0           0   0    0    0   0    0
sent2       0          0      0         0           0   0    1    0   0    0
sent3       0          0      0         0           1   0    0    0   0    0
**********************************************************
word shared by two sentences: [('Monticello', 1)]
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>split into tokens using <a href="####%20basics%20of%20regular%20expressions">regular expressions</a></p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">re</span>
<span class="n">sentence</span> <span class="o">=</span> <span class="s2">"""Thomas Jefferson began building Monticello at the age of 26."""</span>
<span class="n">tokens</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="sa">r</span><span class="s1">'[-\s.,;!?]+'</span><span class="p">,</span> <span class="n">sentence</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'list of tokens:'</span><span class="p">,</span> <span class="n">tokens</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'***********************************************'</span><span class="p">)</span>
<span class="c1"># a better version of tokenization fast and manageable</span>
<span class="n">pattern</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s2">"([-\s.,;!?])+"</span><span class="p">)</span>
<span class="n">tokens</span> <span class="o">=</span> <span class="n">pattern</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">sentence</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'last 10 tokens:'</span><span class="p">,</span> <span class="n">tokens</span><span class="p">[</span><span class="o">-</span><span class="mi">10</span><span class="p">:])</span>  
<span class="c1"># ['the', ' ', 'age', ' ', 'of', ' ', '26', '.', '']</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>list of tokens: ['Thomas', 'Jefferson', 'began', 'building', 'Monticello', 'at', 'the', 'age', 'of', '26', '']
***********************************************
last 10 tokens: [' ', 'the', ' ', 'age', ' ', 'of', ' ', '26', '.', '']
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="ignoring-punctuation">
<a class="anchor" href="#ignoring-punctuation" aria-hidden="true"><span class="octicon octicon-link"></span></a>ignoring punctuation<a class="anchor-link" href="#ignoring-punctuation"> </a>
</h4>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">'removing punctuation:'</span><span class="p">,</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">tokens</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">not</span> <span class="ow">in</span> <span class="s1">'- </span><span class="se">\t\n</span><span class="s1">.,;!?'</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>removing punctuation: ['Thomas', 'Jefferson', 'began', 'building', 'Monticello', 'at', 'the', 'age', 'of', '26']
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="ignoring-whitespaces-with-tokeneizer">
<a class="anchor" href="#ignoring-whitespaces-with-tokeneizer" aria-hidden="true"><span class="octicon octicon-link"></span></a>ignoring whitespaces with tokeneizer<a class="anchor-link" href="#ignoring-whitespaces-with-tokeneizer"> </a>
</h4>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">nltk.tokenize</span> <span class="kn">import</span> <span class="n">RegexpTokenizer</span>
<span class="n">tokenizer</span> <span class="o">=</span> <span class="n">RegexpTokenizer</span><span class="p">(</span><span class="sa">r</span><span class="s1">'\w+|$[0-9.]+|\S+'</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">tokenizer</span><span class="o">.</span><span class="n">tokenize</span><span class="p">(</span><span class="n">sentence</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>['Thomas', 'Jefferson', 'began', 'building', 'Monticello', 'at', 'the', 'age', 'of', '26', '.']
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="managing-contractions-with-tokeneizer">
<a class="anchor" href="#managing-contractions-with-tokeneizer" aria-hidden="true"><span class="octicon octicon-link"></span></a>managing contractions with tokeneizer<a class="anchor-link" href="#managing-contractions-with-tokeneizer"> </a>
</h4>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">nltk.tokenize</span> <span class="kn">import</span> <span class="n">TreebankWordTokenizer</span>
<span class="n">sentence</span> <span class="o">=</span> <span class="s2">"""Monticello wasn't designated as UNESCO World Heritage Site until 1987."""</span>
<span class="n">tokenizer</span> <span class="o">=</span> <span class="n">TreebankWordTokenizer</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">tokenizer</span><span class="o">.</span><span class="n">tokenize</span><span class="p">(</span><span class="n">sentence</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>['Monticello', 'was', "n't", 'designated', 'as', 'UNESCO', 'World', 'Heritage', 'Site', 'until', '1987', '.']
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="tokenize-informal-conversation">
<a class="anchor" href="#tokenize-informal-conversation" aria-hidden="true"><span class="octicon octicon-link"></span></a>tokenize informal conversation<a class="anchor-link" href="#tokenize-informal-conversation"> </a>
</h4>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">nltk.tokenize.casual</span> <span class="kn">import</span> <span class="n">casual_tokenize</span>
<span class="n">message</span> <span class="o">=</span> <span class="s2">"""RT @TJMonticello Best day everrrrrrr at Monticello. Awesommmmmmeeeeeeee day :*)"""</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'tokens:'</span><span class="p">,</span> <span class="n">casual_tokenize</span><span class="p">(</span><span class="n">message</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">'***************************************************'</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'best approach to tokens:'</span><span class="p">,</span> <span class="n">casual_tokenize</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">reduce_len</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">strip_handles</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>tokens: ['RT', '@TJMonticello', 'Best', 'day', 'everrrrrrr', 'at', 'Monticello', '.', 'Awesommmmmmeeeeeeee', 'day', ':*)']
***************************************************
best approach to tokens: ['RT', 'Best', 'day', 'everrr', 'at', 'Monticello', '.', 'Awesommmeee', 'day', ':*)']
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="n-grams">
<a class="anchor" href="#n-grams" aria-hidden="true"><span class="octicon octicon-link"></span></a>n-grams<a class="anchor-link" href="#n-grams"> </a>
</h3>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">nltk.util</span> <span class="kn">import</span> <span class="n">ngrams</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'list of tuples:'</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="n">ngrams</span><span class="p">(</span><span class="n">tokens</span><span class="p">,</span> <span class="mi">2</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'*****************************************************'</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'list of triplets:'</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="n">ngrams</span><span class="p">(</span><span class="n">tokens</span><span class="p">,</span> <span class="mi">3</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'*****************************************************'</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'list of 2-grams'</span><span class="p">,</span> <span class="p">[</span><span class="s1">' '</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">ngrams</span><span class="p">(</span><span class="n">tokens</span><span class="p">,</span> <span class="mi">2</span><span class="p">))])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>list of tuples: [('Thomas', 'Jefferson'), ('Jefferson', 'began'), ('began', 'building'), ('building', 'Monticello'), ('Monticello', 'at'), ('at', 'the'), ('the', 'age'), ('age', 'of'), ('of', '26')]
*****************************************************
list of triplets: [('Thomas', 'Jefferson', 'began'), ('Jefferson', 'began', 'building'), ('began', 'building', 'Monticello'), ('building', 'Monticello', 'at'), ('Monticello', 'at', 'the'), ('at', 'the', 'age'), ('the', 'age', 'of'), ('age', 'of', '26')]
*****************************************************
list of 2-grams ['Thomas Jefferson', 'Jefferson began', 'began building', 'building Monticello', 'Monticello at', 'at the', 'the age', 'age of', 'of 26']
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Stopwords">
<a class="anchor" href="#Stopwords" aria-hidden="true"><span class="octicon octicon-link"></span></a>Stopwords<a class="anchor-link" href="#Stopwords"> </a>
</h3>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">stop_words</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'a'</span><span class="p">,</span> <span class="s1">'an'</span><span class="p">,</span> <span class="s1">'the'</span><span class="p">,</span> <span class="s1">'on'</span><span class="p">,</span> <span class="s1">'of'</span><span class="p">,</span> <span class="s1">'off'</span><span class="p">,</span> <span class="s1">'this'</span><span class="p">,</span> <span class="s1">'is'</span><span class="p">]</span>
<span class="n">tokens</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'the'</span><span class="p">,</span> <span class="s1">'house'</span><span class="p">,</span> <span class="s1">'is'</span><span class="p">,</span> <span class="s1">'on'</span><span class="p">,</span> <span class="s1">'fire'</span><span class="p">]</span>
<span class="n">tokens_without_stopwords</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">tokens</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">stop_words</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'tokens without stopwords:'</span><span class="p">,</span> <span class="n">tokens_without_stopwords</span><span class="p">)</span>

<span class="c1"># canonical stopwords</span>
<span class="kn">import</span> <span class="nn">nltk</span>
<span class="c1">#nltk.download('stopwords')</span>
<span class="n">stop_words</span> <span class="o">=</span> <span class="n">nltk</span><span class="o">.</span><span class="n">corpus</span><span class="o">.</span><span class="n">stopwords</span><span class="o">.</span><span class="n">words</span><span class="p">(</span><span class="s1">'english'</span><span class="p">)</span>
<span class="c1"># print('size of nltk stopwords:', len(stop_words))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'first seven words'</span><span class="p">,</span> <span class="n">stop_words</span><span class="p">[:</span><span class="mi">7</span><span class="p">])</span>
<span class="c1"># ['i', 'me', 'my', 'myself', 'we', 'our', 'ours']</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'stopwords with 1 character in nltk:'</span><span class="p">,</span> <span class="p">[</span><span class="n">sw</span> <span class="k">for</span> <span class="n">sw</span> <span class="ow">in</span> <span class="n">stop_words</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sw</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">])</span>
<span class="c1"># ['i', 'a', 's', 't', 'd', 'm', 'o', 'y']</span>

<span class="c1"># stopwords comparison between sklearn and NLTK</span>
<span class="kn">from</span> <span class="nn">sklearn.feature_extraction.text</span> <span class="kn">import</span> <span class="n">ENGLISH_STOP_WORDS</span> <span class="k">as</span> <span class="n">sklearn_stop_words</span>
<span class="n">nltk_stop_words</span> <span class="o">=</span> <span class="n">nltk</span><span class="o">.</span><span class="n">corpus</span><span class="o">.</span><span class="n">stopwords</span><span class="o">.</span><span class="n">words</span><span class="p">(</span><span class="s1">'english'</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'nltk stopwords:'</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">nltk_stop_words</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'sklearn stopwords:'</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">sklearn_stop_words</span><span class="p">))</span>

<span class="c1">#print(len(nltk_stop_words.union(sklearn_stop_words)))</span>
<span class="c1">#print(len(nltk_stop_words.intersection(sklearn_stop_words)))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>tokens without stopwords: ['house', 'fire']
first seven words ['i', 'me', 'my', 'myself', 'we', 'our', 'ours']
stopwords with 1 character in nltk: ['i', 'a', 's', 't', 'd', 'm', 'o', 'y']
nltk stopwords: 179
sklearn stopwords: 318
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Normalizing-capitalization">
<a class="anchor" href="#Normalizing-capitalization" aria-hidden="true"><span class="octicon octicon-link"></span></a>Normalizing capitalization<a class="anchor-link" href="#Normalizing-capitalization"> </a>
</h3>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tokens</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'House'</span><span class="p">,</span> <span class="s1">'Visitor'</span><span class="p">,</span> <span class="s1">'Center'</span><span class="p">]</span>
<span class="nb">print</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">tokens</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>['house', 'visitor', 'center']
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Stemming">
<a class="anchor" href="#Stemming" aria-hidden="true"><span class="octicon octicon-link"></span></a>Stemming<a class="anchor-link" href="#Stemming"> </a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="stemmer-with-regular-expressions">
<a class="anchor" href="#stemmer-with-regular-expressions" aria-hidden="true"><span class="octicon octicon-link"></span></a>stemmer with regular expressions<a class="anchor-link" href="#stemmer-with-regular-expressions"> </a>
</h4>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">stem</span><span class="p">(</span><span class="n">phrase</span><span class="p">):</span>
    <span class="k">return</span> <span class="s1">' '</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">'^(.*ss|.*?)(s)?$'</span><span class="p">,</span> <span class="n">word</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s2">"'"</span><span class="p">)</span> <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">phrase</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>

<span class="nb">print</span><span class="p">(</span><span class="n">stem</span><span class="p">(</span><span class="s1">'houses'</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">stem</span><span class="p">(</span><span class="s2">"Doctor House's calls"</span><span class="p">))</span>
<span class="c1"># doctor house call</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>house
doctor house call
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="complete-stemmer">
<a class="anchor" href="#complete-stemmer" aria-hidden="true"><span class="octicon octicon-link"></span></a>complete stemmer<a class="anchor-link" href="#complete-stemmer"> </a>
</h4>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">nltk.stem.porter</span> <span class="kn">import</span> <span class="n">PorterStemmer</span>
<span class="n">stemmer</span> <span class="o">=</span> <span class="n">PorterStemmer</span><span class="p">()</span>
<span class="s1">' '</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">stemmer</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">w</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s2">"'"</span><span class="p">)</span> <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="s2">"dish washer's wash dishes"</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="c1"># dish washer wash dish</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>'dish washer wash dish'</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Lemmatization">
<a class="anchor" href="#Lemmatization" aria-hidden="true"><span class="octicon octicon-link"></span></a>Lemmatization<a class="anchor-link" href="#Lemmatization"> </a>
</h3>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">nltk.stem</span> <span class="kn">import</span> <span class="n">WordNetLemmatizer</span>
<span class="c1">#nltk.download('wordnet')</span>
<span class="n">lemmatizer</span> <span class="o">=</span> <span class="n">WordNetLemmatizer</span><span class="p">()</span>
<span class="c1"># if post isn't specified the lemmatizer assumes it is a noun</span>
<span class="nb">print</span><span class="p">(</span><span class="n">lemmatizer</span><span class="o">.</span><span class="n">lemmatize</span><span class="p">(</span><span class="s1">'better'</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">lemmatizer</span><span class="o">.</span><span class="n">lemmatize</span><span class="p">(</span><span class="s1">'better'</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="s1">'a'</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">lemmatizer</span><span class="o">.</span><span class="n">lemmatize</span><span class="p">(</span><span class="s1">'good'</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="s1">'a'</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">lemmatizer</span><span class="o">.</span><span class="n">lemmatize</span><span class="p">(</span><span class="s1">'goods'</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="s1">'a'</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">lemmatizer</span><span class="o">.</span><span class="n">lemmatize</span><span class="p">(</span><span class="s1">'goods'</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="s1">'n'</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">lemmatizer</span><span class="o">.</span><span class="n">lemmatize</span><span class="p">(</span><span class="s1">'goodness'</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="s1">'n'</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">lemmatizer</span><span class="o">.</span><span class="n">lemmatize</span><span class="p">(</span><span class="s1">'best'</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="s1">'a'</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>better
good
good
goods
good
goodness
best
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Sentiment-analysis">
<a class="anchor" href="#Sentiment-analysis" aria-hidden="true"><span class="octicon octicon-link"></span></a>Sentiment analysis<a class="anchor-link" href="#Sentiment-analysis"> </a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="vader-model-for-sentiment-analysis">
<a class="anchor" href="#vader-model-for-sentiment-analysis" aria-hidden="true"><span class="octicon octicon-link"></span></a>vader model for sentiment analysis<a class="anchor-link" href="#vader-model-for-sentiment-analysis"> </a>
</h4>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">vaderSentiment.vaderSentiment</span> <span class="kn">import</span> <span class="n">SentimentIntensityAnalyzer</span>
<span class="n">sa</span> <span class="o">=</span> <span class="n">SentimentIntensityAnalyzer</span><span class="p">()</span>
<span class="n">text1</span> <span class="o">=</span> <span class="s2">"Python is very readable and it is great for NLP."</span>
<span class="n">text2</span> <span class="o">=</span> <span class="s2">"Python is not a bad choice for most applications."</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">'lexicon words with spaces'</span><span class="p">,</span> <span class="p">[(</span><span class="n">tok</span><span class="p">,</span> <span class="n">score</span><span class="p">)</span> <span class="k">for</span> <span class="n">tok</span><span class="p">,</span> <span class="n">score</span> <span class="ow">in</span> <span class="n">sa</span><span class="o">.</span><span class="n">lexicon</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="s2">" "</span> <span class="ow">in</span> <span class="n">tok</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'*******************************************'</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'dict sentiment for text1:'</span><span class="p">,</span> <span class="n">sa</span><span class="o">.</span><span class="n">polarity_scores</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="n">text1</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'dict sentiment for text2:'</span><span class="p">,</span> <span class="n">sa</span><span class="o">.</span><span class="n">polarity_scores</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="n">text2</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>lexicon words with spaces [("( '}{' )", 1.6), ("can't stand", -2.0), ('fed up', -1.8), ('screwed up', -1.5)]
*******************************************
dict sentiment for text1: {'neg': 0.0, 'neu': 0.687, 'pos': 0.313, 'compound': 0.6249}
dict sentiment for text2: {'neg': 0.0, 'neu': 0.737, 'pos': 0.263, 'compound': 0.431}
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="sentiment-score-for-a-given-corpus">
<a class="anchor" href="#sentiment-score-for-a-given-corpus" aria-hidden="true"><span class="octicon octicon-link"></span></a>sentiment score for a given corpus<a class="anchor-link" href="#sentiment-score-for-a-given-corpus"> </a>
</h4>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">corpus</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"Absolutely perfect! Love it! :-) :-) :-)"</span><span class="p">,</span>
          <span class="s2">"Horrible! Completely useless. :("</span><span class="p">,</span>
          <span class="s2">"It was Ok. Some good and some bad things"</span><span class="p">]</span>

<span class="k">for</span> <span class="n">doc</span> <span class="ow">in</span> <span class="n">corpus</span><span class="p">:</span>
    <span class="n">scores</span> <span class="o">=</span> <span class="n">sa</span><span class="o">.</span><span class="n">polarity_scores</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'</span><span class="si">{:+}</span><span class="s1">: </span><span class="si">{}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">scores</span><span class="p">[</span><span class="s1">'compound'</span><span class="p">],</span> <span class="n">doc</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>+0.9428: Absolutely perfect! Love it! :-) :-) :-)
-0.8768: Horrible! Completely useless. :(
-0.1531: It was Ok. Some good and some bad things
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="can't-install-nlpia">
<a class="anchor" href="#can't-install-nlpia" aria-hidden="true"><span class="octicon octicon-link"></span></a>can't install nlpia<a class="anchor-link" href="#can't-install-nlpia"> </a>
</h4>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#from nlpia.data.loaders import get_data</span>
<span class="c1">#movies = get_data('hutto_movies')</span>
<span class="c1">#movies.head().round(2)</span>
<span class="c1">#     sentiment                                            text</span>
<span class="c1"># id</span>
<span class="c1"># 1        2.27  The Rock is destined to be the 21st Century...</span>
<span class="c1"># 2        3.53  The gorgeously elaborate continuation of ''...</span>
<span class="c1"># 3       -0.60                     Effective but too tepid ...</span>
<span class="c1"># 4        1.47  If you sometimes like to go to the movies t...</span>
<span class="c1"># 5        1.73  Emerges as something rare, an issue movie t...</span>
<span class="c1">#movies.describe().round(2)</span>
<span class="c1">#        sentiment</span>
<span class="c1"># count   10605.00</span>
<span class="c1"># mean        0.00</span>
<span class="c1"># min        -3.88</span>
<span class="c1"># max         3.94</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="A-complete-path-for-predicting-sentiment-analysis">
<a class="anchor" href="#A-complete-path-for-predicting-sentiment-analysis" aria-hidden="true"><span class="octicon octicon-link"></span></a>A complete path for predicting sentiment analysis<a class="anchor-link" href="#A-complete-path-for-predicting-sentiment-analysis"> </a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>generate sentiment from movie data. Remember you can't install nlpia where the data movie is</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">reviews_train</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">open</span><span class="p">(</span><span class="s1">'movie_data/full_train.txt'</span><span class="p">,</span> <span class="s1">'r'</span><span class="p">):</span>
    <span class="n">reviews_train</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
<span class="n">movies</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">reviews_train</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">'review'</span><span class="p">])</span>

<span class="n">movies</span><span class="p">[</span><span class="s1">'sentiment'</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">25000</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="c1"># sample the data</span>
<span class="n">movies</span> <span class="o">=</span> <span class="n">movies</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> 
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>convert 'review' column to bag of words</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">nltk.tokenize</span> <span class="kn">import</span> <span class="n">casual_tokenize</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">Counter</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">'display.width'</span><span class="p">,</span> <span class="mi">75</span><span class="p">)</span>
<span class="n">bags_of_words</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># tokenize each row, append into a list of dicts and convert to dataframe</span>
<span class="k">for</span> <span class="n">text</span> <span class="ow">in</span> <span class="n">movies</span><span class="o">.</span><span class="n">review</span><span class="o">.</span><span class="n">to_list</span><span class="p">():</span>
    <span class="n">bags_of_words</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Counter</span><span class="p">(</span><span class="n">casual_tokenize</span><span class="p">(</span><span class="n">text</span><span class="p">)))</span>
<span class="n">df_bows</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_records</span><span class="p">(</span><span class="n">bags_of_words</span><span class="p">)</span>
<span class="n">df_bows</span> <span class="o">=</span> <span class="n">df_bows</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">'bows shape:'</span><span class="p">,</span> <span class="n">df_bows</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'**************************************************'</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'first review:'</span><span class="p">,</span> <span class="n">movies</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">review</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'**************************************************'</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'tokens of the first review that appear in the first 5 rows of the dataset'</span><span class="p">,</span> 
      <span class="n">df_bows</span><span class="o">.</span><span class="n">head</span><span class="p">()[</span><span class="nb">list</span><span class="p">(</span><span class="n">bags_of_words</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">())])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>bows shape: (1000, 22298)
**************************************************
first review: I'll give writer/director William Gove credit for finding someone to finance this ill-conceived "thriller." A good argument for not wasting money subscribing to HBO, let alone buying DVDs based on cover art and blurbs. A pedestrian Dennis Hopper and a game Richard Grieco add nothing significant to their resumes, although the art direction is not half bad. The dialogue will leave you grimacing with wonder at its conceit; this is storytelling at its worst. No tension, no suspense, no dread, no fear, no empathy, no catharsis, no nothing. A few attractive and often nude females spice up the boredom, but this is definitely a film best seen as a trailer. I feel sorry for the guy who greenlighted this thing. Good for late-night, zoned-out viewing only. You have been warned.
**************************************************
tokens of the first review that appear in the first 5 rows of the dataset    I'll  give  writer   /  director  William  Gove  credit  for  finding  \
0     1     1       1   1         1        1     1       1    4        1   
1     0     0       0  12         0        0     0       0    2        0   
2     0     0       0   0         0        0     0       0    1        0   
3     0     0       0   6         1        0     0       0    3        0   
4     0     0       0   4         0        0     0       0    2        0   

   ...  thing  Good  late-night  zoned-out  viewing  only  You  have  \
0  ...      1     1           1          1        1     1    1     1   
1  ...      0     0           0          0        0     0    0     2   
2  ...      1     0           0          0        0     1    0     1   
3  ...      0     0           0          0        0     0    0     0   
4  ...      0     0           0          0        0     2    0     0   

   been  warned  
0     1       1  
1     0       0  
2     0       0  
3     0       0  
4     0       0  

[5 rows x 108 columns]
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>predict the sentiment and computing metrics for accuracy</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.naive_bayes</span> <span class="kn">import</span> <span class="n">MultinomialNB</span>
<span class="n">nb</span> <span class="o">=</span> <span class="n">MultinomialNB</span><span class="p">()</span>

<span class="c1"># fit the model and convert continuous to boolean label</span>
<span class="n">nb</span> <span class="o">=</span> <span class="n">nb</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">df_bows</span><span class="p">,</span> <span class="n">movies</span><span class="o">.</span><span class="n">sentiment</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>

<span class="c1"># values from review columns goes from -4 to 4 so this code normalize to the "ground true" sentiment</span>
<span class="n">movies</span><span class="p">[</span><span class="s1">'predicted_sentiment'</span><span class="p">]</span> <span class="o">=</span> <span class="n">nb</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">df_bows</span><span class="p">)[:,</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="mi">8</span> <span class="o">-</span> <span class="mi">4</span>  
<span class="n">movies</span><span class="p">[</span><span class="s1">'error'</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">movies</span><span class="o">.</span><span class="n">predicted_sentiment</span> <span class="o">-</span> <span class="n">movies</span><span class="o">.</span><span class="n">sentiment</span><span class="p">)</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span>

<span class="c1"># metrics</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'MAE:'</span><span class="p">,</span> <span class="n">movies</span><span class="o">.</span><span class="n">error</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span> 

<span class="c1"># support columns</span>
<span class="n">movies</span><span class="p">[</span><span class="s1">'sentiment_ispositive'</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">movies</span><span class="o">.</span><span class="n">sentiment</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="n">movies</span><span class="p">[</span><span class="s1">'predicted_ispositive'</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">movies</span><span class="o">.</span><span class="n">predicted_sentiment</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="n">movies</span><span class="p">[</span><span class="s1">'''sentiment predicted_sentiment sentiment_ispositive predicted_ispositive'''</span><span class="o">.</span><span class="n">split</span><span class="p">()]</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>

<span class="c1">#     sentiment  predicted_sentiment  sentiment_ispositive  predicted_ispositive</span>
<span class="c1"># id</span>
<span class="c1"># 1    2.266667                   4                    1                    1</span>
<span class="c1"># 2    3.533333                   4                    1                    1</span>
<span class="c1"># 3   -0.600000                  -4                    0                    0</span>
<span class="c1"># 4    1.466667                   4                    1                    1</span>
<span class="c1"># 5    1.733333                   4                    1                    1</span>
<span class="c1"># 6    2.533333                   4                    1                    1</span>
<span class="c1"># 7    2.466667                   4                    1                    1</span>
<span class="c1"># 8    1.266667                  -4                    1                    0</span>

<span class="c1"># prediction over positives</span>
<span class="p">(</span><span class="n">movies</span><span class="o">.</span><span class="n">predicted_ispositive</span> <span class="o">==</span> <span class="n">movies</span><span class="o">.</span><span class="n">sentiment_ispositive</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">movies</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>MAE: 2.0512326689917173
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>0.993</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">nb</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span> <span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

</div>



  </div><a class="u-url" href="/nlp2/fastpages/jupyter/2021/02/13/nlp-in-action-i.html" hidden></a>
</article>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/nlp2/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/nlp2/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/nlp2/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>An easy way to consult NLP tools.</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/fastai" title="fastai"><svg class="svg-icon grey"><use xlink:href="/nlp2/assets/minima-social-icons.svg#github"></use></svg></a></li><li><a rel="me" href="https://twitter.com/fastdotai" title="fastdotai"><svg class="svg-icon grey"><use xlink:href="/nlp2/assets/minima-social-icons.svg#twitter"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
